"fun.rs.perc.gradient" <-
function(coeff, u = 0.1, data)
{
L3 <- coeff[1]
L4 <- coeff[1]
pp <- fun.lambda.percentile(data)
a <- pp$p3
b <- pp$p4
c((1/2 * (2 * (((1 - u)^L4 - u^L3 + 0.5^L3 - 0.5^L4)/((1 - u)^L3 - u^L4 + 0.5^L4 - 0.5^L3) - a) * (( - u^L3 * log(u) - 0.6931471806 *
0.5^L3)/((1 - u)^L3 - u^L4 + 0.5^L4 - 0.5^L3) - (((1 - u)^L4 - u^L3 + 0.5^L3 - 0.5^L4) * ((1 - u)^L3 * log(1 - u) + 
0.6931471806 * 0.5^L3))/(((1 - u)^L3 - u^L4 + 0.5^L4 - 0.5^L3)^2)) + 2 * ((0.75^L3 - 0.25^L4 + 0.75^L4 - 0.25^L3)/((1 - u)^
L3 - u^L4 + (1 - u)^L4 - u^L3) - b) * ((-0.2876820725 * 0.75^L3 + 1.386294361 * 0.25^L3)/((1 - u)^L3 - u^L4 + (1 - u)^L4 -
u^L3) - ((0.75^L3 - 0.25^L4 + 0.75^L4 - 0.25^L3) * ((1 - u)^L3 * log(1 - u) - u^L3 * log(u)))/(((1 - u)^L3 - u^L4 + (1 - u)^
L4 - u^L3)^2))))/(sqrt((((1 - u)^L4 - u^L3 + 0.5^L3 - 0.5^L4)/((1 - u)^L3 - u^L4 + 0.5^L4 - 0.5^L3) - a)^2 + ((0.75^L3 - 0.25^
L4 + 0.75^L4 - 0.25^L3)/((1 - u)^L3 - u^L4 + (1 - u)^L4 - u^L3) - b)^2)), (1/2 * (2 * (((1 - u)^L4 - u^L3 + 0.5^L3 - 0.5^
L4)/((1 - u)^L3 - u^L4 + 0.5^L4 - 0.5^L3) - a) * (((1 - u)^L4 * log(1 - u) + 0.6931471806 * 0.5^L4)/((1 - u)^L3 - u^L4 + 0.5^
L4 - 0.5^L3) - (((1 - u)^L4 - u^L3 + 0.5^L3 - 0.5^L4) * ( - u^L4 * log(u) - 0.6931471806 * 0.5^L4))/(((1 - u)^L3 - u^L4 + 0.5^
L4 - 0.5^L3)^2)) + 2 * ((0.75^L3 - 0.25^L4 + 0.75^L4 - 0.25^L3)/((1 - u)^L3 - u^L4 + (1 - u)^L4 - u^L3) - b) * ((1.386294361 *
0.25^L4 - 0.2876820725 * 0.75^L4)/((1 - u)^L3 - u^L4 + (1 - u)^L4 - u^L3) - ((0.75^L3 - 0.25^L4 + 0.75^L4 - 0.25^L3) * ( -
u^L4 * log(u) + (1 - u)^L4 * log(1 - u)))/(((1 - u)^L3 - u^L4 + (1 - u)^L4 - u^L3)^2))))/(sqrt((((1 - u)^L4 - u^L3 + 0.5^
L3 - 0.5^L4)/((1 - u)^L3 - u^L4 + 0.5^L4 - 0.5^L3) - a)^2 + ((0.75^L3 - 0.25^L4 + 0.75^L4 - 0.25^L3)/((1 - u)^L3 - u^L4 + (
1 - u)^L4 - u^L3) - b)^2)))
}

